THREE.MTLLoader=function(e,t,n){this.baseUrl=e;this.options=t;this.crossOrigin=n};THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,n,r){var i=this;var s=new THREE.XHRLoader;s.setCrossOrigin(this.crossOrigin);s.load(e,function(e){t(i.parse(e))},n,r)},parse:function(e){var t=e.split("\n");var n={};var r=/\s+/;var i={};for(var s=0;s<t.length;s++){var o=t[s];o=o.trim();if(o.length===0||o.charAt(0)==="#"){continue}var u=o.indexOf(" ");var a=u>=0?o.substring(0,u):o;a=a.toLowerCase();var f=u>=0?o.substring(u+1):"";f=f.trim();if(a==="newmtl"){n={name:f};i[f]=n}else if(n){if(a==="ka"||a==="kd"||a==="ks"){var l=f.split(r,3);n[a]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else{n[a]=f}}}var c=new THREE.MTLLoader.MaterialCreator(this.baseUrl,this.options);c.setMaterials(i);return c}};THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e;this.options=t;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping};THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setMaterials:function(e){this.materialsInfo=this.convert(e);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var n in e){var r=e[n];var i={};t[n]=i;for(var s in r){var o=true;var u=r[s];var a=s.toLowerCase();switch(a){case"kd":case"ka":case"ks":if(this.options&&this.options.normalizeRGB){u=[u[0]/255,u[1]/255,u[2]/255]}if(this.options&&this.options.ignoreZeroRGBs){if(u[0]===0&&u[1]===0&&u[1]===0){o=false}}break;case"d":if(this.options&&this.options.invertTransparency){u=1-u}break;default:break}if(o){i[a]=u}}}return t},preload:function(){for(var e in this.materialsInfo){this.create(e)}},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo){this.materialsArray[e]=this.create(t);this.nameLookup[t]=e;e++}return this.materialsArray},create:function(e){if(this.materials[e]===undefined){this.createMaterial_(e)}return this.materials[e]},createMaterial_:function(e){var t=this.materialsInfo[e];var n={name:e,side:this.side};for(var r in t){var i=t[r];switch(r.toLowerCase()){case"kd":n["diffuse"]=(new THREE.Color).fromArray(i);break;case"ka":n["ambient"]=(new THREE.Color).fromArray(i);break;case"ks":n["specular"]=(new THREE.Color).fromArray(i);break;case"map_kd":n["map"]=this.loadTexture(i);n["map"].wrapS=this.wrap;n["map"].wrapT=this.wrap;break;case"ns":n["shininess"]=i;break;case"d":if(i<1){n["transparent"]=true;n["opacity"]=i}break;default:break}}if(n["diffuse"]){if(!n["ambient"])n["ambient"]=n["diffuse"];n["color"]=n["diffuse"]}this.materials[e]=new THREE.MeshPhongMaterial(n);return this.materials[e]},loadTexture:function(e,t,n,r){var i;var s=THREE.Loader.Handlers.get(e);if(s!==null){i=s.load(e,n)}else{i=new THREE.Texture;s=new THREE.ImageLoader;s.crossOrigin=this.crossOrigin;s.load(e,function(e){i.image=THREE.MTLLoader.ensurePowerOfTwo_(e);i.needsUpdate=true;if(n)n(i)})}i.mapping=t;return i}};THREE.MTLLoader.ensurePowerOfTwo_=function(e){if(!THREE.Math.isPowerOfTwo(e.width)||!THREE.Math.isPowerOfTwo(e.height)){var t=document.createElement("canvas");t.width=THREE.MTLLoader.nextHighestPowerOfTwo_(e.width);t.height=THREE.MTLLoader.nextHighestPowerOfTwo_(e.height);var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height);return t}return e};THREE.MTLLoader.nextHighestPowerOfTwo_=function(e){--e;for(var t=1;t<32;t<<=1){e=e|e>>t}return e+1};THREE.EventDispatcher.prototype.apply(THREE.MTLLoader.prototype); THREE.OBJMTLLoader=function(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager};THREE.OBJMTLLoader.prototype={constructor:THREE.OBJMTLLoader,load:function(e,t,n,r,i){var s=this;var o=new THREE.MTLLoader(e.substr(0,e.lastIndexOf("/")+1));o.load(t,function(t){var o=t;o.preload();var u=new THREE.XHRLoader(s.manager);u.setCrossOrigin(this.crossOrigin);u.load(e,function(e){var t=s.parse(e);t.traverse(function(e){if(e instanceof THREE.Mesh){if(e.material.name){var t=o.create(e.material.name);if(t)e.material=t}}});n(t)},r,i)},r,i)},parse:function(e,t){function n(e,t,n){return new THREE.Vector3(e,t,n)}function r(e,t){return new THREE.Vector2(e,t)}function i(e,t,n,r){return new THREE.Face3(e,t,n,r)}function o(e,t){if(h.length>0){f.vertices=h;f.mergeVertices();f.computeFaceNormals();f.computeBoundingSphere();a.add(c);f=new THREE.Geometry;c=new THREE.Mesh(f,l)}if(e!==undefined)c.name=e;if(t!==undefined){l=new THREE.MeshLambertMaterial;l.name=t;c.material=l}}function v(e,t,n,r){if(r===undefined){f.faces.push(i(parseInt(e)-(s+1),parseInt(t)-(s+1),parseInt(n)-(s+1)))}else{f.faces.push(i(parseInt(e)-(s+1),parseInt(t)-(s+1),parseInt(n)-(s+1),[p[parseInt(r[0])-1].clone(),p[parseInt(r[1])-1].clone(),p[parseInt(r[2])-1].clone()]))}}function m(e,t,n){f.faceVertexUvs[0].push([d[parseInt(e)-1].clone(),d[parseInt(t)-1].clone(),d[parseInt(n)-1].clone()])}function g(e,t,n){if(e[3]===undefined){v(e[0],e[1],e[2],n);if(!(t===undefined)&&t.length>0){m(t[0],t[1],t[2])}}else{if(!(n===undefined)&&n.length>0){v(e[0],e[1],e[3],[n[0],n[1],n[3]]);v(e[1],e[2],e[3],[n[1],n[2],n[3]])}else{v(e[0],e[1],e[3]);v(e[1],e[2],e[3])}if(!(t===undefined)&&t.length>0){m(t[0],t[1],t[3]);m(t[1],t[2],t[3])}}}var s=0;var u=new THREE.Group;var a=u;var f=new THREE.Geometry;var l=new THREE.MeshLambertMaterial;var c=new THREE.Mesh(f,l);var h=[];var p=[];var d=[];var y=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;var b=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;var w=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;var E=/f( +\d+)( +\d+)( +\d+)( +\d+)?/;var S=/f( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))?/;var x=/f( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))?/;var T=/f( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))?/;var N=e.split("\n");for(var C=0;C<N.length;C++){var k=N[C];k=k.trim();var L;if(k.length===0||k.charAt(0)==="#"){continue}else if((L=y.exec(k))!==null){h.push(n(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])))}else if((L=b.exec(k))!==null){p.push(n(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])))}else if((L=w.exec(k))!==null){d.push(r(parseFloat(L[1]),parseFloat(L[2])))}else if((L=E.exec(k))!==null){g([L[1],L[2],L[3],L[4]])}else if((L=S.exec(k))!==null){g([L[2],L[5],L[8],L[11]],[L[3],L[6],L[9],L[12]])}else if((L=x.exec(k))!==null){g([L[2],L[6],L[10],L[14]],[L[3],L[7],L[11],L[15]],[L[4],L[8],L[12],L[16]])}else if((L=T.exec(k))!==null){g([L[2],L[5],L[8],L[11]],[],[L[3],L[6],L[9],L[12]])}else if(/^o /.test(k)){o();s=s+h.length;h=[];a=new THREE.Object3D;a.name=k.substring(2).trim();u.add(a)}else if(/^g /.test(k)){o(k.substring(2).trim(),undefined)}else if(/^usemtl /.test(k)){o(undefined,k.substring(7).trim())}else if(/^mtllib /.test(k)){if(t){var A=k.substring(7);A=A.trim();t(A)}}else if(/^s /.test(k)){}else{console.log("THREE.OBJMTLLoader: Unhandled line "+k)}}o(undefined,undefined);return u}};THREE.EventDispatcher.prototype.apply(THREE.OBJMTLLoader.prototype);THREE.OrbitControls=function(e,t){function L(){return 2*Math.PI/60/60*n.autoRotateSpeed}function A(){return Math.pow(.95,n.zoomSpeed)}function O(e){if(n.enabled===false)return;e.preventDefault();if(e.button===n.mouseButtons.ORBIT){if(n.noRotate===true)return;S=E.ROTATE;i.set(e.clientX,e.clientY)}else if(e.button===n.mouseButtons.ZOOM){if(n.noZoom===true)return;S=E.DOLLY;h.set(e.clientX,e.clientY)}else if(e.button===n.mouseButtons.PAN){if(n.noPan===true)return;S=E.PAN;u.set(e.clientX,e.clientY)}document.addEventListener("mousemove",M,false);document.addEventListener("mouseup",_,false);n.dispatchEvent(C)}function M(e){if(n.enabled===false)return;e.preventDefault();var t=n.domElement===document?n.domElement.body:n.domElement;if(S===E.ROTATE){if(n.noRotate===true)return;s.set(e.clientX,e.clientY);o.subVectors(s,i);n.rotateLeft(2*Math.PI*o.x/t.clientWidth*n.rotateSpeed);n.rotateUp(2*Math.PI*o.y/t.clientHeight*n.rotateSpeed);i.copy(s)}else if(S===E.DOLLY){if(n.noZoom===true)return;p.set(e.clientX,e.clientY);d.subVectors(p,h);if(d.y>0){n.dollyIn()}else{n.dollyOut()}h.copy(p)}else if(S===E.PAN){if(n.noPan===true)return;a.set(e.clientX,e.clientY);f.subVectors(a,u);n.pan(f.x,f.y);u.copy(a)}n.update()}function _(){if(n.enabled===false)return;document.removeEventListener("mousemove",M,false);document.removeEventListener("mouseup",_,false);n.dispatchEvent(k);S=E.NONE}function D(e){if(n.enabled===false||n.noZoom===true)return;e.preventDefault();e.stopPropagation();var t=0;if(e.wheelDelta!==undefined){t=e.wheelDelta}else if(e.detail!==undefined){t=-e.detail}if(t>0){n.dollyOut()}else{n.dollyIn()}n.update();n.dispatchEvent(C);n.dispatchEvent(k)}function P(e){if(n.enabled===false||n.noKeys===true||n.noPan===true)return;switch(e.keyCode){case n.keys.UP:n.pan(0,n.keyPanSpeed);n.update();break;case n.keys.BOTTOM:n.pan(0,-n.keyPanSpeed);n.update();break;case n.keys.LEFT:n.pan(n.keyPanSpeed,0);n.update();break;case n.keys.RIGHT:n.pan(-n.keyPanSpeed,0);n.update();break}}function H(e){if(n.enabled===false)return;switch(e.touches.length){case 1:if(n.noRotate===true)return;S=E.TOUCH_ROTATE;i.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(n.noZoom===true)return;S=E.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX;var r=e.touches[0].pageY-e.touches[1].pageY;var s=Math.sqrt(t*t+r*r);h.set(0,s);break;case 3:if(n.noPan===true)return;S=E.TOUCH_PAN;u.set(e.touches[0].pageX,e.touches[0].pageY);break;default:S=E.NONE}n.dispatchEvent(C)}function B(e){if(n.enabled===false)return;e.preventDefault();e.stopPropagation();var t=n.domElement===document?n.domElement.body:n.domElement;switch(e.touches.length){case 1:if(n.noRotate===true)return;if(S!==E.TOUCH_ROTATE)return;s.set(e.touches[0].pageX,e.touches[0].pageY);o.subVectors(s,i);n.rotateLeft(2*Math.PI*o.x/t.clientWidth*n.rotateSpeed);n.rotateUp(2*Math.PI*o.y/t.clientHeight*n.rotateSpeed);i.copy(s);n.update();break;case 2:if(n.noZoom===true)return;if(S!==E.TOUCH_DOLLY)return;var r=e.touches[0].pageX-e.touches[1].pageX;var l=e.touches[0].pageY-e.touches[1].pageY;var c=Math.sqrt(r*r+l*l);p.set(0,c);d.subVectors(p,h);if(d.y>0){n.dollyOut()}else{n.dollyIn()}h.copy(p);n.update();break;case 3:if(n.noPan===true)return;if(S!==E.TOUCH_PAN)return;a.set(e.touches[0].pageX,e.touches[0].pageY);f.subVectors(a,u);n.pan(f.x,f.y);u.copy(a);n.update();break;default:S=E.NONE}}function j(){if(n.enabled===false)return;n.dispatchEvent(k);S=E.NONE}this.object=e;this.domElement=t!==undefined?t:document;this.enabled=true;this.target=new THREE.Vector3;this.center=this.target;this.noZoom=false;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=false;this.rotateSpeed=1;this.noPan=false;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.noKeys=false;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE};var n=this;var r=1e-6;var i=new THREE.Vector2;var s=new THREE.Vector2;var o=new THREE.Vector2;var u=new THREE.Vector2;var a=new THREE.Vector2;var f=new THREE.Vector2;var l=new THREE.Vector3;var c=new THREE.Vector3;var h=new THREE.Vector2;var p=new THREE.Vector2;var d=new THREE.Vector2;var v=0;var m=0;var g=1;var y=new THREE.Vector3;var b=new THREE.Vector3;var w=new THREE.Quaternion;var E={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var S=E.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();var x=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0));var T=x.clone().inverse();var N={type:"change"};var C={type:"start"};var k={type:"end"};this.rotateLeft=function(e){if(e===undefined){e=L()}m-=e};this.rotateUp=function(e){if(e===undefined){e=L()}v-=e};this.panLeft=function(e){var t=this.object.matrix.elements;l.set(t[0],t[1],t[2]);l.multiplyScalar(-e);y.add(l)};this.panUp=function(e){var t=this.object.matrix.elements;l.set(t[4],t[5],t[6]);l.multiplyScalar(e);y.add(l)};this.pan=function(e,t){var r=n.domElement===document?n.domElement.body:n.domElement;if(n.object.fov!==undefined){var i=n.object.position;var s=i.clone().sub(n.target);var o=s.length();o*=Math.tan(n.object.fov/2*Math.PI/180);n.panLeft(2*e*o/r.clientHeight);n.panUp(2*t*o/r.clientHeight)}else if(n.object.top!==undefined){n.panLeft(e*(n.object.right-n.object.left)/r.clientWidth);n.panUp(t*(n.object.top-n.object.bottom)/r.clientHeight)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")}};this.dollyIn=function(e){if(e===undefined){e=A()}g/=e};this.dollyOut=function(e){if(e===undefined){e=A()}g*=e};this.update=function(){var e=this.object.position;c.copy(e).sub(this.target);c.applyQuaternion(x);var t=Math.atan2(c.x,c.z);var n=Math.atan2(Math.sqrt(c.x*c.x+c.z*c.z),c.y);if(this.autoRotate){this.rotateLeft(L())}t+=m;n+=v;t=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,t));n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n));n=Math.max(r,Math.min(Math.PI-r,n));var i=c.length()*g;i=Math.max(this.minDistance,Math.min(this.maxDistance,i));this.target.add(y);c.x=i*Math.sin(n)*Math.sin(t);c.y=i*Math.cos(n);c.z=i*Math.sin(n)*Math.cos(t);c.applyQuaternion(T);e.copy(this.target).add(c);this.object.lookAt(this.target);m=0;v=0;g=1;y.set(0,0,0);if(b.distanceToSquared(this.object.position)>r||8*(1-w.dot(this.object.quaternion))>r){this.dispatchEvent(N);b.copy(this.object.position);w.copy(this.object.quaternion)}};this.reset=function(){S=E.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.update()};this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},false);this.domElement.addEventListener("mousedown",O,false);this.domElement.addEventListener("mousewheel",D,false);this.domElement.addEventListener("DOMMouseScroll",D,false);this.domElement.addEventListener("touchstart",H,false);this.domElement.addEventListener("touchend",j,false);this.domElement.addEventListener("touchmove",B,false);window.addEventListener("keydown",P,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);